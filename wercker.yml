box: wercker/android
# Build definition
build:
  # The steps that will be executed on build
  steps:
    - android-sdk-update:
        filter: sysimg-18

    - script:
        name: setup emulator
        code: |
          echo no | android create avd --force -n test -t android-18 --abi armeabi-v7a
          emulator -avd test -no-skin -no-audio -no-window --enable-kvm & 
          ./wait_for_emulator.sh
    - script:
        name: run gradle connectedInstrumentTest
        code: |
          gradle cIT --full-stacktrace -q
    # - script:
    #     name: show base information
    #     code: |
    #       gradle -v
    #       echo ANDROID_HOME
    #       echo ANDROID_BUILD_TOOLS
    #       echo ANDROID_UPDATE_FILTER

    # - script:
    #     name: gradle robolectric
    #     code: |
    #       export
    #       gradle --full-stacktrace -q --project-cache-dir=$WERCKER_CACHE_DIR robolectric
    # # A step that executes `gradle build` command
    # - script:
    #     name: run gradle
    #     code: |
    #       gradle --full-stacktrace -q --project-cache-dir=$WERCKER_CACHE_DIR build
